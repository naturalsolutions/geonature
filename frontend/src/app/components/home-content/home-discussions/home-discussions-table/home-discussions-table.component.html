<ngx-datatable
  #table
  class="material striped margin-top-xs table-size expandable"
  [rows]="discussions"
  headerHeight="50"
  footerHeight="50"
  rowHeight="100"
  [limit]="perPage"
  [count]="count"
  [offset]="offset"
  (sort)="onColumnSort($event)"
  [externalSorting]="true"
>
  <ngx-datatable-column
    [maxWidth]="5"
    [resizeable]="false"
    [sortable]="false"
    [draggable]="false"
    [canAutoResize]="false"
  >
    <ng-template
      let-row="row"
      ngx-datatable-cell-template
    >
      <button
        class="btn btn-outline-shadow btn-no-padding btn-ghost"
        (click)="navigateToDiscussion(row.id_synthese)"
      >
        <i
          #iElement
          [matTooltip]="'Voir le fil de discussion lié à la synthese id : ' + row.id_synthese"
          class="fa fa-info-circle"
          aria-hidden="true "
        ></i>
      </button>
    </ng-template>
  </ngx-datatable-column>
  <ngx-datatable-column
    width="150"
    [prop]="PROP_CREATION_DATE"
    name="Date commentaire"
    [sortable]="true"
    [resizeable]="true"
    [canAutoResize]="true"
  >
    <ng-template
      ngx-datatable-cell-template
      let-row="row"
    >
      {{ renderDate(row[PROP_CREATION_DATE]) }}
    </ng-template>
  </ngx-datatable-column>
  <ngx-datatable-column
    width="150"
    [prop]="PROP_USER"
    name="Auteur"
    [sortable]="true"
    [resizeable]="true"
    [canAutoResize]="true"
  >
    <ng-template
      ngx-datatable-cell-template
      let-row="row"
    >
      {{ row[PROP_USER] }}
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column
    [prop]="PROP_CONTENT"
    width="500"
    height="100"
    name="Contenu"
    [sortable]="true"
    [resizeable]="true"
    [canAutoResize]="true"
  >
    <ng-template
      ngx-datatable-cell-template
      let-row="row"
    >
      <div class="TextContentContainer">
        <div class="TextContent">
          {{ row[PROP_CONTENT] }}
        </div>
      </div>
    </ng-template>
  </ngx-datatable-column>
  <ngx-datatable-column
    width="500"
    [prop]="PROP_OBSERVATION"
    name="Observation"
    [sortable]="false"
    [resizeable]="true"
  >
    <ng-template
      ngx-datatable-cell-template
      let-row="row"
    >
      <span [innerHTML]="row.observation"></span>
    </ng-template>
  </ngx-datatable-column>
  <ngx-datatable-footer>
    <ng-template
      ngx-datatable-footer-template
      let-rowCount="rowCount"
      let-pageSize="pageSize"
      let-curPage="curPage"
      let-offset="offset"
    >
      {{ totalFilteredRows }} / {{ totalRows }} total
      <datatable-pager
        [pagerLeftArrowIcon]="'datatable-icon-left'"
        [pagerRightArrowIcon]="'datatable-icon-right'"
        [pagerPreviousIcon]="'datatable-icon-prev'"
        [pagerNextIcon]="'datatable-icon-skip'"
        [page]="curPage"
        [size]="pageSize"
        [count]="totalRows"
        (change)="handlePageChange($event)"
      ></datatable-pager>
    </ng-template>
  </ngx-datatable-footer>
</ngx-datatable>
